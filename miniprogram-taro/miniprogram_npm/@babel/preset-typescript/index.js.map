{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar helperPluginUtils = require('@babel/helper-plugin-utils');\nvar transformTypeScript = require('@babel/plugin-transform-typescript');\nrequire('@babel/plugin-syntax-jsx');\nvar transformModulesCommonJS = require('@babel/plugin-transform-modules-commonjs');\nvar helperValidatorOption = require('@babel/helper-validator-option');\n\nfunction _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }\n\nvar transformTypeScript__default = /*#__PURE__*/_interopDefault(transformTypeScript);\nvar transformModulesCommonJS__default = /*#__PURE__*/_interopDefault(transformModulesCommonJS);\n\nconst v = new helperValidatorOption.OptionValidator(\"@babel/preset-typescript\");\nfunction normalizeOptions(options = {}) {\n  let {\n    allowNamespaces = true,\n    jsxPragma,\n    onlyRemoveTypeImports\n  } = options;\n  const TopLevelOptions = {\n    ignoreExtensions: \"ignoreExtensions\",\n    allowNamespaces: \"allowNamespaces\",\n    disallowAmbiguousJSXLike: \"disallowAmbiguousJSXLike\",\n    jsxPragma: \"jsxPragma\",\n    jsxPragmaFrag: \"jsxPragmaFrag\",\n    onlyRemoveTypeImports: \"onlyRemoveTypeImports\",\n    optimizeConstEnums: \"optimizeConstEnums\",\n    rewriteImportExtensions: \"rewriteImportExtensions\",\n    allExtensions: \"allExtensions\",\n    isTSX: \"isTSX\"\n  };\n  const jsxPragmaFrag = v.validateStringOption(TopLevelOptions.jsxPragmaFrag, options.jsxPragmaFrag, \"React.Fragment\");\n  {\n    var allExtensions = v.validateBooleanOption(TopLevelOptions.allExtensions, options.allExtensions, false);\n    var isTSX = v.validateBooleanOption(TopLevelOptions.isTSX, options.isTSX, false);\n    if (isTSX) {\n      v.invariant(allExtensions, \"isTSX:true requires allExtensions:true\");\n    }\n  }\n  const ignoreExtensions = v.validateBooleanOption(TopLevelOptions.ignoreExtensions, options.ignoreExtensions, false);\n  const disallowAmbiguousJSXLike = v.validateBooleanOption(TopLevelOptions.disallowAmbiguousJSXLike, options.disallowAmbiguousJSXLike, false);\n  if (disallowAmbiguousJSXLike) {\n    {\n      v.invariant(allExtensions, \"disallowAmbiguousJSXLike:true requires allExtensions:true\");\n    }\n  }\n  const optimizeConstEnums = v.validateBooleanOption(TopLevelOptions.optimizeConstEnums, options.optimizeConstEnums, false);\n  const rewriteImportExtensions = v.validateBooleanOption(TopLevelOptions.rewriteImportExtensions, options.rewriteImportExtensions, false);\n  const normalized = {\n    ignoreExtensions,\n    allowNamespaces,\n    disallowAmbiguousJSXLike,\n    jsxPragma,\n    jsxPragmaFrag,\n    onlyRemoveTypeImports,\n    optimizeConstEnums,\n    rewriteImportExtensions\n  };\n  {\n    normalized.allExtensions = allExtensions;\n    normalized.isTSX = isTSX;\n  }\n  return normalized;\n}\n\nvar pluginRewriteTSImports = helperPluginUtils.declare(function ({\n  types: t,\n  template\n}) {\n  function maybeReplace(source, path, state) {\n    if (!source) return;\n    if (t.isStringLiteral(source)) {\n      if (/^\\.\\.?\\//.test(source.value)) {\n        source.value = source.value.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? \".js\" : d && (!ext || !cm) ? m : d + ext + \".\" + cm.toLowerCase() + \"js\";\n        });\n      }\n      return;\n    }\n    if (state.availableHelper(\"tsRewriteRelativeImportExtensions\")) {\n      path.replaceWith(t.callExpression(state.addHelper(\"tsRewriteRelativeImportExtensions\"), [source]));\n    } else {\n      path.replaceWith(template.expression.ast`(${source} + \"\").replace(/([\\\\/].*\\.[mc]?)tsx?$/, \"$1js\")`);\n    }\n  }\n  return {\n    name: \"preset-typescript/plugin-rewrite-ts-imports\",\n    visitor: {\n      \"ImportDeclaration|ExportAllDeclaration|ExportNamedDeclaration\"(path, state) {\n        const node = path.node;\n        const kind = t.isImportDeclaration(node) ? node.importKind : node.exportKind;\n        if (kind === \"value\") {\n          maybeReplace(node.source, path.get(\"source\"), state);\n        }\n      },\n      CallExpression(path, state) {\n        if (t.isImport(path.node.callee)) {\n          maybeReplace(path.node.arguments[0], path.get(\"arguments.0\"), state);\n        }\n      },\n      ImportExpression(path, state) {\n        maybeReplace(path.node.source, path.get(\"source\"), state);\n      }\n    }\n  };\n});\n\nvar index = helperPluginUtils.declarePreset((api, opts) => {\n  api.assertVersion(7);\n  const {\n    allExtensions,\n    ignoreExtensions,\n    allowNamespaces,\n    disallowAmbiguousJSXLike,\n    isTSX,\n    jsxPragma,\n    jsxPragmaFrag,\n    onlyRemoveTypeImports,\n    optimizeConstEnums,\n    rewriteImportExtensions\n  } = normalizeOptions(opts);\n  const pluginOptions = disallowAmbiguousJSXLike => ({\n    allowDeclareFields: opts.allowDeclareFields,\n    allowNamespaces,\n    disallowAmbiguousJSXLike,\n    jsxPragma,\n    jsxPragmaFrag,\n    onlyRemoveTypeImports,\n    optimizeConstEnums\n  });\n  const getPlugins = (isTSX, disallowAmbiguousJSXLike) => {\n    {\n      return [[transformTypeScript__default.default, Object.assign({\n        isTSX\n      }, pluginOptions(disallowAmbiguousJSXLike))]];\n    }\n  };\n  const disableExtensionDetect = allExtensions || ignoreExtensions;\n  return {\n    plugins: rewriteImportExtensions ? [pluginRewriteTSImports] : [],\n    overrides: disableExtensionDetect ? [{\n      plugins: getPlugins(isTSX, disallowAmbiguousJSXLike)\n    }] : [{\n      test: /\\.ts$/,\n      plugins: getPlugins(false, false)\n    }, {\n      test: /\\.mts$/,\n      sourceType: \"module\",\n      plugins: getPlugins(false, true)\n    }, {\n      test: /\\.cts$/,\n      sourceType: \"unambiguous\",\n      plugins: [[transformModulesCommonJS__default.default, {\n        allowTopLevelThis: true\n      }], [transformTypeScript__default.default, pluginOptions(true)]]\n    }, {\n      test: /\\.tsx$/,\n      plugins: getPlugins(true, false)\n    }]\n  };\n});\n\nexports.default = index;\n//# sourceMappingURL=index.js.map\n"]}