{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar shared = require('@tarojs/shared');\nvar runtime = require('@tarojs/runtime');\nvar Reconciler = require('react-reconciler');\nvar constants = require('react-reconciler/constants');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar Reconciler__default = /*#__PURE__*/_interopDefaultLegacy(Reconciler);\n\nvar supportedInputTypes = {\n    color: true,\n    date: true,\n    datetime: true,\n    'datetime-local': true,\n    email: true,\n    month: true,\n    number: true,\n    password: true,\n    range: true,\n    search: true,\n    tel: true,\n    text: true,\n    time: true,\n    url: true,\n    week: true,\n};\nvar SyncLane = 1;\nvar InputContinuousLane = 4;\nvar DefaultLane = 16;\nvar DiscreteEventPriority = SyncLane;\nvar ContinuousEventPriority = InputContinuousLane;\nvar DefaultEventPriority = DefaultLane;\nfunction getEventPriority(domEventName) {\n    switch (domEventName) {\n        case 'cancel':\n        case 'click':\n        case 'close':\n        case 'contextmenu':\n        case 'copy':\n        case 'cut':\n        case 'dragend':\n        case 'dragstart':\n        case 'drop':\n        case 'input':\n        case 'paste':\n        case 'pause':\n        case 'play':\n        case 'pointercancel':\n        case 'pointerdown':\n        case 'pointerup':\n        case 'reset':\n        case 'resize':\n        case 'submit':\n        case 'touchcancel':\n        case 'touchend':\n        case 'touchstart':\n        case 'change':\n        case 'blur':\n        case 'focus':\n        case 'select':\n        case 'selectstart':\n            return DiscreteEventPriority;\n        case 'drag':\n        case 'dragenter':\n        case 'dragexit':\n        case 'dragleave':\n        case 'dragover':\n        case 'pointermove':\n        case 'pointerout':\n        case 'pointerover':\n        case 'scroll':\n        case 'toggle':\n        case 'touchmove':\n        case 'pointerenter':\n        case 'pointerleave':\n            return ContinuousEventPriority;\n        default:\n            return DefaultEventPriority;\n    }\n}\nvar randomKey = Math.random()\n    .toString(36)\n    .slice(2);\nvar internalPropsKey = '__reactProps$' + randomKey;\nvar internalInstanceKey = '__reactFiber$' + randomKey;\nvar internalContainerInstanceKey = '__reactContainer$' + randomKey;\n// const internalEventHandlersKey = '__reactEvents$' + randomKey\n// const internalEventHandlerListenersKey = '__reactListeners$' + randomKey\n// const internalEventHandlesSetKey = '__reactHandles$' + randomKey\n\nvar HostRoot = 3; // Root of a host tree. Could be nested inside another node.\nvar HostComponent = 5;\nvar HostText = 6;\nvar SuspenseComponent = 13;\n\n/**\n * 给 TaroElement 绑定 react fiber、react props 等属性\n * 提供 fiber -> element、element -> fiber、element -> props 的方法\n*/\nfunction precacheFiberNode(hostInst, node) {\n    node[internalInstanceKey] = hostInst;\n}\nfunction markContainerAsRoot(hostRoot, node) {\n    node[internalContainerInstanceKey] = hostRoot;\n}\n/**\n * Given a DOM node, return the ReactDOMComponent or ReactDOMTextComponent\n * instance, or null if the node was not rendered by this React.\n */\nfunction getInstanceFromNode(node) {\n    var inst = node[internalInstanceKey] || node[internalContainerInstanceKey];\n    if (inst) {\n        if (inst.tag === HostComponent ||\n            inst.tag === HostText ||\n            inst.tag === SuspenseComponent ||\n            inst.tag === HostRoot) {\n            return inst;\n        }\n        else {\n            return null;\n        }\n    }\n    return null;\n}\n/**\n * Given a ReactDOMComponent or ReactDOMTextComponent, return the corresponding\n * DOM node.\n */\nfunction getNodeFromInstance(inst) {\n    if (inst.tag === HostComponent || inst.tag === HostText) {\n        // In Fiber this, is just the state node right now. We assume it will be\n        // a host component or host text.\n        return inst.stateNode;\n    }\n}\nfunction getFiberCurrentPropsFromNode(node) {\n    return node[internalPropsKey] || null;\n}\nfunction updateFiberProps(node, props) {\n    node[internalPropsKey] = props;\n}\n\n// 从 props 中，更新 input 组件的 value 值\nfunction updateInputWrapper(element, oldValue, props) {\n    var node = element;\n    var checked = props.checked;\n    if (checked != null) {\n        console.warn('updateCheck 未实现', node);\n        return;\n    }\n    updateWrapper(element, oldValue, props);\n    updateNamedCousins(element, props);\n}\n// react 中原本处理 type=radio 的逻辑，这里留个空，暂时不处理\nfunction updateNamedCousins(rootNode, props) {\n    var name = props.name;\n    if (props.type === 'radio' && name != null) {\n        console.warn('radio updateNamedCousins 未实现', rootNode, props);\n    }\n}\nfunction getToStringValue(value) {\n    var isEmptyType = typeof value === 'function' || typeof value === 'symbol';\n    return isEmptyType ? '' : value;\n}\nfunction toString(value) {\n    return '' + value;\n}\nfunction updateWrapper(element, oldValue, props) {\n    var node = element;\n    var value = getToStringValue(props.value);\n    var type = props.type;\n    setNodeValue(node, oldValue, value, type);\n}\n// oldValue 为 event.detail.value，value 为 fiber.props.value\n// 如果 oldValue 和 value 不相等，代表受控组件需要更新\n// 更新的原则为，fiber.props.value 永远为用户所需要的值，因此 node.value = toString(value)\nfunction setNodeValue(node, oldValue, value, type) {\n    if ( type === void 0 ) type = 'string';\n\n    if (value != null) {\n        if (type === 'number') {\n            if ((value === 0 && node.value === '') ||\n                // We explicitly want to coerce to number here if possible.\n                // eslint-disable-next-line\n                oldValue != value) {\n                node.value = toString(value);\n            }\n        }\n        else if (oldValue !== toString(value)) {\n            node.value = toString(value);\n        }\n    }\n    else if (type === 'submit' || type === 'reset') {\n        // Submit/reset inputs need the attribute removed completely to avoid\n        // blank-text buttons.\n        node.removeAttribute('value');\n    }\n}\n// 判断当前 TaroElement 是否为 supportedInputTypes input 或 textarea\nfunction isTextInputElement(elem) {\n    var nodeName = elem && elem.nodeName && elem.nodeName.toLowerCase();\n    if (nodeName === 'input') {\n        var type = elem.type;\n        return !type || !!supportedInputTypes[type];\n    }\n    if (nodeName === 'textarea') {\n        return true;\n    }\n    return false;\n}\nvar ReactDOMTextareaRestoreControlledState = updateWrapper;\nvar ReactDOMInputRestoreControlledState = updateInputWrapper;\n\nfunction isCheckable(elem) {\n    var type = elem.type;\n    var nodeName = elem.nodeName;\n    return (nodeName &&\n        nodeName.toLowerCase() === 'input' &&\n        (type === 'checkbox' || type === 'radio'));\n}\nfunction getTracker(node) {\n    return node._valueTracker;\n}\nfunction detachTracker(node) {\n    node._valueTracker = null;\n}\n// 之所以单独创建一个 tacker，是为了统一监听不同 type 的 input 值\n// 比如 type=checkbox 或者 type=radio，就需要监听 checked，而不是 value\n// 虽然目前还未实现 checkbox 和 radio 的 finishEventHandle，但后续不好说，所以先统一和 react 一样的写法\n// 需要特别注意的是，tracker 初始化时的值为 node 的初始值，但后续会变更为事件的 detail.value 值\nfunction trackValueOnNode(node) {\n    var valueField = isCheckable(node) ? 'checked' : 'value';\n    var descriptor = Object.getOwnPropertyDescriptor(node.constructor.prototype, valueField);\n    var currentValue = '' + node[valueField];\n    if (node.hasOwnProperty(valueField) ||\n        typeof descriptor === 'undefined' ||\n        typeof descriptor.get !== 'function' ||\n        typeof descriptor.set !== 'function') {\n        return;\n    }\n    var get = descriptor.get;\n    var set = descriptor.set;\n    Object.defineProperty(node, valueField, {\n        configurable: true,\n        enumerable: descriptor.enumerable,\n        get: function () {\n            return get.call(this);\n        },\n        set: function (value) {\n            currentValue = '' + value;\n            set.call(this, value);\n        },\n    });\n    var tracker = {\n        getValue: function getValue() {\n            return currentValue;\n        },\n        setValue: function setValue(value) {\n            currentValue = '' + value;\n        },\n        stopTracking: function stopTracking() {\n            detachTracker(node);\n            delete node[valueField];\n        },\n    };\n    return tracker;\n}\nfunction track(node) {\n    if (getTracker(node)) {\n        return;\n    }\n    node._valueTracker = trackValueOnNode(node);\n}\nfunction updateValueIfChanged(node, nextValue) {\n    if (!node) {\n        return false;\n    }\n    var tracker = getTracker(node);\n    if (!tracker) {\n        return true;\n    }\n    var lastValue = tracker.getValue();\n    if (nextValue !== lastValue) {\n        tracker.setValue(nextValue);\n        return true;\n    }\n    return false;\n}\n\nfunction isEventName(s) {\n    return s[0] === 'o' && s[1] === 'n';\n}\nvar IS_NON_DIMENSIONAL = /aspect|acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;\nfunction updateProps(dom, oldProps, newProps) {\n    var updatePayload = getUpdatePayload(dom, oldProps, newProps);\n    if (updatePayload) {\n        updatePropsByPayload(dom, oldProps, updatePayload);\n    }\n}\nfunction updatePropsByPayload(dom, oldProps, updatePayload) {\n    for (var i = 0; i < updatePayload.length; i += 2) { // key, value 成对出现\n        var key = updatePayload[i];\n        var newProp = updatePayload[i + 1];\n        var oldProp = oldProps[key];\n        setProperty(dom, key, newProp, oldProp);\n    }\n}\nfunction getUpdatePayload(dom, oldProps, newProps) {\n    var i;\n    var updatePayload = null;\n    for (i in oldProps) {\n        if (!(i in newProps)) {\n            (updatePayload = updatePayload || []).push(i, null);\n        }\n    }\n    var isFormElement = dom instanceof runtime.FormElement;\n    for (i in newProps) {\n        if (oldProps[i] !== newProps[i] || (isFormElement && i === 'value')) {\n            (updatePayload = updatePayload || []).push(i, newProps[i]);\n        }\n    }\n    return updatePayload;\n}\n// function eventProxy (e: CommonEvent) {\n//   const el = document.getElementById(e.currentTarget.id)\n//   const handlers = el!.__handlers[e.type]\n//   handlers[0](e)\n// }\nfunction setEvent(dom, name, value, oldValue) {\n    var isCapture = name.endsWith('Capture');\n    var eventName = name.toLowerCase().slice(2);\n    if (isCapture) {\n        eventName = eventName.slice(0, -7);\n    }\n    var compName = shared.capitalize(shared.toCamelCase(dom.tagName.toLowerCase()));\n    if (eventName === 'click' && compName in shared.internalComponents) {\n        eventName = 'tap';\n    }\n    if (shared.isFunction(value)) {\n        if (oldValue) {\n            dom.removeEventListener(eventName, oldValue, false);\n            dom.addEventListener(eventName, value, { isCapture: isCapture, sideEffect: false });\n        }\n        else {\n            dom.addEventListener(eventName, value, isCapture);\n        }\n    }\n    else {\n        dom.removeEventListener(eventName, oldValue);\n    }\n}\nfunction setStyle(style, key, value) {\n    if (key[0] === '-') {\n        style.setProperty(key, value.toString());\n        // css variables need not further judgment\n        return;\n    }\n    style[key] =\n        shared.isNumber(value) && IS_NON_DIMENSIONAL.test(key) === false\n            ? value + 'px'\n            : value == null\n                ? ''\n                : value;\n}\nfunction setProperty(dom, name, value, oldValue) {\n    var _a, _b;\n    name = name === 'className' ? 'class' : name;\n    if (name === 'key' ||\n        name === 'children' ||\n        name === 'ref') ;\n    else if (name === 'style') {\n        var style = dom.style;\n        if (shared.isString(value)) {\n            style.cssText = value;\n        }\n        else {\n            if (shared.isString(oldValue)) {\n                style.cssText = '';\n                oldValue = null;\n            }\n            if (shared.isObject(oldValue)) {\n                for (var i in oldValue) {\n                    if (!(value && i in value)) {\n                        setStyle(style, i, '');\n                    }\n                }\n            }\n            if (shared.isObject(value)) {\n                for (var i$1 in value) {\n                    if (!oldValue || value[i$1] !== oldValue[i$1]) {\n                        setStyle(style, i$1, value[i$1]);\n                    }\n                }\n            }\n        }\n    }\n    else if (isEventName(name)) {\n        setEvent(dom, name, value, oldValue);\n    }\n    else if (name === 'dangerouslySetInnerHTML') {\n        var newHtml = (_a = value === null || value === void 0 ? void 0 : value.__html) !== null && _a !== void 0 ? _a : '';\n        var oldHtml = (_b = oldValue === null || oldValue === void 0 ? void 0 : oldValue.__html) !== null && _b !== void 0 ? _b : '';\n        if (newHtml || oldHtml) {\n            if (oldHtml !== newHtml) {\n                dom.innerHTML = newHtml;\n            }\n        }\n    }\n    else if (!shared.isFunction(value)) {\n        if (value == null) {\n            dom.removeAttribute(name);\n        }\n        else {\n            dom.setAttribute(name, value);\n        }\n    }\n}\n\n/* eslint-disable @typescript-eslint/indent */\nvar hostConfig = {\n    // below keys order by {React ReactFiberHostConfig.custom.js}, convenient for comparing each other.\n    // -------------------\n    // required by @types/react-reconciler\n    // -------------------\n    getPublicInstance: function getPublicInstance(inst) {\n        return inst;\n    },\n    getRootHostContext: function getRootHostContext() {\n        return {};\n    },\n    getChildHostContext: function getChildHostContext(parentHostContext) {\n        return parentHostContext;\n    },\n    prepareForCommit: function prepareForCommit() {\n\n        return null;\n    },\n    resetAfterCommit: shared.noop,\n    createInstance: function createInstance(type, props, _rootContainerInstance, _hostContext, internalInstanceHandle) {\n        var element = runtime.document.createElement(type);\n        precacheFiberNode(internalInstanceHandle, element);\n        updateFiberProps(element, props);\n        return element;\n    },\n    appendInitialChild: function appendInitialChild(parent, child) {\n        parent.appendChild(child);\n    },\n    finalizeInitialChildren: function finalizeInitialChildren(dom, type, props) {\n        var obj;\n\n        var newProps = props;\n        if (dom instanceof runtime.FormElement) {\n            var ref = ['switch', 'checkbox', 'radio'].includes(type) ? ['checked', 'defaultChecked'] : ['value', 'defaultValue'];\n            var defaultName = ref[0];\n            var defaultKey = ref[1];\n            if (props.hasOwnProperty(defaultKey)) {\n                newProps = Object.assign(Object.assign({}, newProps), ( obj = {}, obj[defaultName] = props[defaultKey], obj ));\n                delete newProps[defaultKey];\n            }\n        }\n        updateProps(dom, {}, newProps); // 提前执行更新属性操作，Taro 在 Page 初始化后会立即从 dom 读取必要信息\n        if (type === 'input' || type === 'textarea') {\n            track(dom);\n        }\n        return false;\n    },\n    prepareUpdate: function prepareUpdate(instance, _, oldProps, newProps) {\n        return getUpdatePayload(instance, oldProps, newProps);\n    },\n    shouldSetTextContent: function shouldSetTextContent() {\n        return false;\n    },\n    createTextInstance: function createTextInstance(text, _rootContainerInstance, _hostContext, internalInstanceHandle) {\n        var textNode = runtime.document.createTextNode(text);\n        precacheFiberNode(internalInstanceHandle, textNode);\n        return textNode;\n    },\n    scheduleTimeout: setTimeout,\n    cancelTimeout: clearTimeout,\n    noTimeout: -1,\n    isPrimaryRenderer: true,\n    warnsIfNotActing: true,\n    supportsMutation: true,\n    supportsPersistence: false,\n    supportsHydration: false,\n    getInstanceFromNode: function () { return null; },\n    beforeActiveInstanceBlur: shared.noop,\n    afterActiveInstanceBlur: shared.noop,\n    preparePortalMount: shared.noop,\n    prepareScopeUpdate: shared.noop,\n    getInstanceFromScope: function () { return null; },\n    getCurrentEventPriority: function getCurrentEventPriority() {\n        return constants.DefaultEventPriority;\n    },\n    detachDeletedInstance: shared.noop,\n    // -------------------\n    //      Microtasks\n    //     (optional)\n    // -------------------\n    supportsMicrotasks: true,\n    scheduleMicrotask: shared.isUndefined(Promise)\n        ? setTimeout\n        : function (callback) { return Promise.resolve(null)\n            .then(callback)\n            .catch(function (error) {\n            setTimeout(function () {\n                throw error;\n            });\n        }); },\n    // -------------------\n    //      Mutation\n    //     (required if supportsMutation is true)\n    // -------------------\n    appendChild: function appendChild(parent, child) {\n        parent.appendChild(child);\n    },\n    appendChildToContainer: function appendChildToContainer(parent, child) {\n        parent.appendChild(child);\n    },\n    commitTextUpdate: function commitTextUpdate(textInst, _, newText) {\n        textInst.nodeValue = newText;\n    },\n    commitMount: shared.noop,\n    commitUpdate: function commitUpdate(dom, updatePayload, _, oldProps, newProps) {\n        updatePropsByPayload(dom, oldProps, updatePayload);\n        updateFiberProps(dom, newProps);\n    },\n    insertBefore: function insertBefore(parent, child, refChild) {\n        parent.insertBefore(child, refChild);\n    },\n    insertInContainerBefore: function insertInContainerBefore(parent, child, refChild) {\n        parent.insertBefore(child, refChild);\n    },\n    removeChild: function removeChild(parent, child) {\n        parent.removeChild(child);\n    },\n    removeChildFromContainer: function removeChildFromContainer(parent, child) {\n        parent.removeChild(child);\n    },\n    resetTextContent: shared.noop,\n    hideInstance: function hideInstance(instance) {\n        var style = instance.style;\n        style.setProperty('display', 'none');\n    },\n    hideTextInstance: function hideTextInstance(textInstance) {\n        textInstance.nodeValue = '';\n    },\n    unhideInstance: function unhideInstance(instance, props) {\n        var styleProp = props.style;\n        var display = (styleProp === null || styleProp === void 0 ? void 0 : styleProp.hasOwnProperty('display')) ? styleProp.display : null;\n        display = display == null || shared.isBoolean(display) || display === '' ? '' : ('' + display).trim();\n        // eslint-disable-next-line dot-notation\n        instance.style['display'] = display;\n    },\n    unhideTextInstance: function unhideTextInstance(textInstance, text) {\n        textInstance.nodeValue = text;\n    },\n    clearContainer: function clearContainer(element) {\n        if (element.childNodes.length > 0) {\n            element.textContent = '';\n        }\n    }\n};\nvar TaroReconciler = Reconciler__default[\"default\"](hostConfig);\nif (process.env.NODE_ENV !== 'production') {\n    var foundDevTools = TaroReconciler.injectIntoDevTools({\n        bundleType: 1,\n        version: '18.0.0',\n        rendererPackageName: 'taro-react'\n    });\n    if (!foundDevTools) {\n        // eslint-disable-next-line no-console\n        console.info('%cDownload the React DevTools ' +\n            'for a better development experience: ' +\n            'https://reactjs.org/link/react-devtools', 'font-weight:bold');\n    }\n}\n\nvar restoreQueue = null;\n// 对比 TaroElement tracker 下的 value 和事件下的 value，判断 element 的值是否存在更改\nfunction getTargetInstForInputOrChangeEvent(e, node) {\n    var _a, _b;\n    var targetInst = getInstanceFromNode(node);\n    var domEventName = e.type;\n    if (!targetInst || !isTextInputElement(node))\n        { return; }\n    if (domEventName === 'input' || domEventName === 'change') {\n        var nextValue = toString((_b = (_a = e.mpEvent) === null || _a === void 0 ? void 0 : _a.detail) === null || _b === void 0 ? void 0 : _b.value);\n        return getInstIfValueChanged(targetInst, nextValue);\n    }\n}\nfunction getInstIfValueChanged(targetInst, nextValue) {\n    var targetNode = getNodeFromInstance(targetInst);\n    if (!targetNode)\n        { return false; }\n    if (updateValueIfChanged(targetNode, nextValue)) {\n        return targetInst;\n    }\n}\n// 把 target 塞入更新队列中\nfunction enqueueStateRestore(target) {\n    if (restoreQueue) {\n        restoreQueue.push(target);\n    }\n    else {\n        restoreQueue = [target];\n    }\n}\n// 判断是否需要恢复 target（input、textarea） 的状态\nfunction needsStateRestore() {\n    return restoreQueue !== null;\n}\nfunction finishEventHandler() {\n    var controlledComponentsHavePendingUpdates = needsStateRestore();\n    if (controlledComponentsHavePendingUpdates) {\n        TaroReconciler.flushSync();\n        restoreStateIfNeeded();\n    }\n}\n// 遍历 restoreQueue、restoreTarget，恢复其状态\nfunction restoreStateIfNeeded() {\n    if (!restoreQueue) {\n        return;\n    }\n    var queuedTargets = restoreQueue;\n    restoreQueue = null;\n    for (var i = 0; i < queuedTargets.length; i++) {\n        restoreStateOfTarget(queuedTargets[i]);\n    }\n}\nfunction restoreImpl(domElement, tag, oldValue, props) {\n    switch (tag) {\n        case 'input':\n            ReactDOMInputRestoreControlledState(domElement, oldValue, props);\n            break;\n        case 'textarea':\n            ReactDOMTextareaRestoreControlledState(domElement, oldValue, props);\n            break;\n    }\n}\nfunction restoreStateOfTarget(item) {\n    var internalInstance = getInstanceFromNode(item.target);\n    if (!internalInstance)\n        { return; }\n    var stateNode = internalInstance.stateNode;\n    var type = internalInstance.type;\n    if (stateNode) {\n        var props = getFiberCurrentPropsFromNode(stateNode);\n        restoreImpl(stateNode, type, item.value, props);\n    }\n}\n\nvar ContainerMap = new WeakMap();\nvar Root = function Root(renderer, domContainer, options) {\n    this.renderer = renderer;\n    this.initInternalRoot(renderer, domContainer, options);\n};\nRoot.prototype.initInternalRoot = function initInternalRoot (renderer, domContainer, options) {\n    // Since react-reconciler v0.27, createContainer need more parameters\n    // @see:https://github.com/facebook/react/blob/0b974418c9a56f6c560298560265dcf4b65784bc/packages/react-reconciler/src/ReactFiberReconciler.js#L248\n    var containerInfo = domContainer;\n    if (options) {\n        var tag = 1; // ConcurrentRoot\n        var concurrentUpdatesByDefaultOverride = false;\n        var isStrictMode = false;\n        var identifierPrefix = '';\n        var onRecoverableError = function (error) { return console.error(error); };\n        var transitionCallbacks = null;\n        if (options.unstable_strictMode === true) {\n            isStrictMode = true;\n        }\n        if (options.identifierPrefix !== undefined) {\n            identifierPrefix = options.identifierPrefix;\n        }\n        if (options.onRecoverableError !== undefined) {\n            onRecoverableError = options.onRecoverableError;\n        }\n        if (options.unstable_transitionCallbacks !== undefined) {\n            transitionCallbacks = options.unstable_transitionCallbacks;\n        }\n        this.internalRoot = renderer.createContainer(containerInfo, tag, null, // hydrationCallbacks\n        isStrictMode, concurrentUpdatesByDefaultOverride, identifierPrefix, onRecoverableError, transitionCallbacks);\n    }\n    else {\n        var tag$1 = 0; // LegacyRoot\n        this.internalRoot = renderer.createContainer(containerInfo, tag$1, null, // hydrationCallbacks\n        false, // isStrictMode\n        false, // concurrentUpdatesByDefaultOverride,\n        '', // identifierPrefix\n        function () { }, // onRecoverableError, this isn't reachable because onRecoverableError isn't called in the legacy API.\n        null // transitionCallbacks\n        );\n    }\n};\nRoot.prototype.render = function render (children, cb) {\n    var ref = this;\n        var renderer = ref.renderer;\n        var internalRoot = ref.internalRoot;\n    renderer.updateContainer(children, internalRoot, null, cb);\n    return renderer.getPublicRootInstance(internalRoot);\n};\nRoot.prototype.unmount = function unmount (cb) {\n    this.renderer.updateContainer(null, this.internalRoot, null, cb);\n};\nfunction render(element, domContainer, cb) {\n    var oldRoot = ContainerMap.get(domContainer);\n    if (oldRoot != null) {\n        return oldRoot.render(element, cb);\n    }\n    var root = new Root(TaroReconciler, domContainer);\n    ContainerMap.set(domContainer, root);\n    return root.render(element, cb);\n}\nfunction createRoot(domContainer, options) {\n    if ( options === void 0 ) options = {};\n\n    var _a;\n    var oldRoot = ContainerMap.get(domContainer);\n    if (oldRoot != null) {\n        return oldRoot;\n    }\n    // options should be an object\n    var root = new Root(TaroReconciler, domContainer, options);\n    ContainerMap.set(domContainer, root);\n    markContainerAsRoot((_a = root === null || root === void 0 ? void 0 : root.internalRoot) === null || _a === void 0 ? void 0 : _a.current, domContainer);\n    runtime.hooks.tap('dispatchTaroEvent', function (e, node) {\n        var eventPriority = getEventPriority(e.type);\n        TaroReconciler.runWithPriority(eventPriority, function () {\n            node.dispatchEvent(e);\n        });\n    });\n    // 对比 event.detail.value 和 node.tracker.value，判断 value 值是否有变动，存在变动则塞入队列中\n    runtime.hooks.tap('modifyTaroEvent', function (e, node) {\n        var _a, _b;\n        var inst = getTargetInstForInputOrChangeEvent(e, node);\n        if (!inst)\n            { return; }\n        // 这里塞入的是 event.detail.value，也就是事件的值，在受控组件中，你可以理解为需要被变更的值\n        // 后续会在 finishEventHandler 中，使用最新的 fiber.props.value 来与其比较\n        // 如果不一致，则表示需要更新，会执行 node.value = fiber.props.value 的更新操作\n        var nextValue = (_b = (_a = e.mpEvent) === null || _a === void 0 ? void 0 : _a.detail) === null || _b === void 0 ? void 0 : _b.value;\n        enqueueStateRestore({ target: node, value: nextValue });\n    });\n    return root;\n}\n\nvar isInsideEventHandler = false;\n// 重新包裹 batchedUpdates，使其可以在触发事件后执行 finishEventHandler\nvar unstable_batchedUpdates = function (fn, a) {\n    if (isInsideEventHandler) {\n        return fn(a);\n    }\n    isInsideEventHandler = true;\n    try {\n        return TaroReconciler.batchedUpdates(fn, a);\n    }\n    finally {\n        isInsideEventHandler = false;\n        finishEventHandler();\n    }\n};\nfunction unmountComponentAtNode(dom) {\n    shared.ensure(dom && [1, 8, 9, 11].includes(dom.nodeType), 'unmountComponentAtNode(...): Target container is not a DOM element.');\n    var root = ContainerMap.get(dom);\n    if (!root)\n        { return false; }\n    unstable_batchedUpdates(function () {\n        root.unmount(function () {\n            ContainerMap.delete(dom);\n        });\n    }, null);\n    return true;\n}\nfunction findDOMNode(comp) {\n    if (comp == null) {\n        return null;\n    }\n    var nodeType = comp.nodeType;\n    if (nodeType === 1 || nodeType === 3) {\n        return comp;\n    }\n    return TaroReconciler.findHostInstance(comp);\n}\nvar portalType = shared.isFunction(Symbol) && Symbol.for\n    ? Symbol.for('react.portal')\n    : 0xeaca;\nfunction createPortal(children, containerInfo, key) {\n    return {\n        $$typeof: portalType,\n        key: key == null ? null : String(key),\n        children: children,\n        containerInfo: containerInfo,\n        implementation: null\n    };\n}\nvar index = {\n    render: render,\n    createRoot: createRoot,\n    unstable_batchedUpdates: unstable_batchedUpdates,\n    unmountComponentAtNode: unmountComponentAtNode,\n    findDOMNode: findDOMNode,\n    createPortal: createPortal\n};\n\nexports.createPortal = createPortal;\nexports.createRoot = createRoot;\nexports[\"default\"] = index;\nexports.findDOMNode = findDOMNode;\nexports.render = render;\nexports.unmountComponentAtNode = unmountComponentAtNode;\nexports.unstable_batchedUpdates = unstable_batchedUpdates;\n//# sourceMappingURL=index.js.map\n"]}