{"version":3,"sources":["index.js","dist/index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;ACFA,ADGA;ACFA,ADGA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["module.exports = require('./dist/index.js').default\n\nmodule.exports.default = module.exports\nmodule.exports.TT = require('./dist/index.js').TT\n","\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar webpackSources = require('webpack-sources');\nvar service = require('@tarojs/service');\nvar shared = require('@tarojs/shared');\nvar template = require('@tarojs/shared/dist/template');\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nconst _true = '!0';\nconst _false = '!1';\nconst _empty = '';\nconst components = {\n    // ======== 调整属性 ========\n    Icon: {\n        size: '24'\n    },\n    Input: {\n        'adjust-position': _true,\n        'hold-keyboard': _false,\n        'clue-type': '0',\n        bindKeyboardHeightChange: _empty,\n    },\n    Button: {\n        bindGetPhoneNumber: _empty,\n        'data-channel': _empty,\n        'data-aweme-id': _empty,\n        'group-id': _empty,\n        'data-is-half-page': _empty,\n        bindOpenAwemeUserProfile: _empty,\n        bindJoinGroup: _empty,\n    },\n    Form: {\n        'report-submit-timeout': '0'\n    },\n    Slider: {\n        color: shared.singleQuote('#e9e9e9'),\n        'selected-color': shared.singleQuote('#1aad19')\n    },\n    WebView: {\n        'progressbar-color': shared.singleQuote('#51a0d8')\n    },\n    Video: {\n        'play-btn-position': shared.singleQuote('center'),\n        'pre-roll-unit-id': _empty,\n        'post-roll-unit-id': _empty,\n        'vslide-gesture': _false,\n        'vslide-gesture-in-fullscreen': _true,\n        'enable-play-gesture': _false,\n        'show-playback-rate-btn': _false,\n        'enable-play-in-background': _false,\n        signature: _empty,\n        bindProgress: _empty,\n        bindSeekComplete: _empty,\n        bindAdLoad: _empty,\n        bindAdStart: _empty,\n        bindAdEnded: _empty,\n        bindAdError: _empty,\n        bindAdClose: _empty,\n        bindLoadedMetadata: _empty,\n        bindPlaybackRateChange: _empty,\n        bindMuteChange: _empty,\n        bindControlTap: _empty,\n        bindEnterBackground: _empty,\n        bindCloseBackground: _empty,\n        bindLeaveBackground: _empty,\n    },\n    Ad: {\n        fixed: _empty,\n        type: shared.singleQuote('banner'),\n        scale: '100'\n    },\n    Textarea: {\n        'disable-default-padding': _false,\n        'confirm-type': shared.singleQuote('return'),\n        'confirm-hold': _false,\n        'show-confirm-bar': _true,\n        'adjust-position': _true,\n        'hold-keyboard': _false\n    },\n    ScrollView: {\n        enhanced: _false,\n        bounces: _true,\n        'refresher-enabled': _false,\n        'refresher-threshold': '55',\n        'refresher-default-style': \"'black'\",\n        'refresher-background': \"'#FFF'\",\n        'refresher-triggered': _false,\n        bindRefresherPulling: _empty,\n        bindRefresherRefresh: _empty,\n        bindRefresherRestore: _empty,\n        bindRefresherAbort: _empty,\n    },\n    Canvas: {\n        type: _empty\n    },\n    Map: {\n        polygons: '[]',\n        rotate: '0',\n        skew: '0',\n        'max-scale': '19',\n        'min-scale': '3',\n        'enable-3D': _false,\n        'show-compass': _false,\n        'show-scale': _false,\n        'enable-overlooking': _false,\n        'enable-zoom': _true,\n        'enable-scroll': _true,\n        'enable-rotate': _false,\n        'enable-satellite': _false,\n        'enable-traffic': _false,\n        'enable-poi': _true,\n        'enable-building': _true,\n        bindLabelTap: _empty,\n        bindRegionChange: _empty,\n        bindAnchorPointTap: _empty\n    },\n    // ======== 额外组件 ========\n    RtcRoom: {\n        'user-id': _empty,\n        mode: 'camera',\n        'device-position': 'front',\n        bindError: _empty\n    },\n    PayButton: {\n        mode: '1',\n        'goods-id': _empty,\n        'goods-type': _empty,\n        'order-status': '0',\n        'order-id': _empty,\n        'refund-id': _empty,\n        'refund-total-amount': _empty,\n        'biz-line': '1',\n        'marketing-ready': _false,\n        bindGetGoodsInfo: _empty,\n        bindPlaceOrder: _empty,\n        bindError: _empty,\n        bindApplyRefund: _empty,\n        bindRefund: _empty,\n        bindPay: _empty\n    },\n    ConsumeCard: {\n        'order-id': _empty,\n        bindConsume: _empty,\n        bindRefund: _empty,\n        bindApplyRefund: _empty,\n        bindError: _empty\n    },\n    AwemeData: {\n        'aweme-id': _empty,\n        type: shared.singleQuote('avatar'),\n        'disable-default': _empty,\n        'default-avatar': _empty,\n        'default-text': _empty,\n        bindError: _empty\n    },\n    RateButton: {\n        'order-id': _empty,\n        bindInit: _empty,\n        bindSuccess: _empty,\n        bindError: _empty,\n    },\n    OpenData: {\n        type: _empty,\n        'default-text': _empty,\n        'default-avatar': _empty,\n        'use-empty-value': _false,\n        bindError: _empty\n    },\n    AwemeUserCard: {\n        'aweme-id': _empty,\n        width: '504',\n        height: '144',\n        fixed: _false,\n        'left-right-padding': _empty,\n        bindError: _empty\n    }\n};\n\nclass Template extends template.RecursiveTemplate {\n    constructor() {\n        super(...arguments);\n        this.supportXS = true;\n        this.Adapter = {\n            if: 'tt:if',\n            else: 'tt:else',\n            elseif: 'tt:elif',\n            for: 'tt:for',\n            forItem: 'tt:for-item',\n            forIndex: 'tt:for-index',\n            key: 'tt:key',\n            xs: 'sjs',\n            type: 'tt'\n        };\n    }\n    replacePropName(name, value) {\n        if (value === 'eh') {\n            const nameLowerCase = name.toLowerCase();\n            if (nameLowerCase === 'bindlongtap')\n                return 'bindlongpress';\n            return nameLowerCase;\n        }\n        return name;\n    }\n    buildXsTemplate(filePath = './utils') {\n        return `<sjs module=\"xs\" src=\"${filePath}.sjs\" />`;\n    }\n}\n\nconst PACKAGE_NAME = '@tarojs/plugin-platform-tt';\nclass TT extends service.TaroPlatformBase {\n    /**\n     * 1. setupTransaction - init\n     * 2. setup\n     * 3. setupTransaction - close\n     * 4. buildTransaction - init\n     * 5. build\n     * 6. buildTransaction - close\n     */\n    constructor(ctx, config) {\n        super(ctx, config);\n        this.platform = 'tt';\n        this.globalObject = 'tt';\n        this.projectConfigJson = 'project.tt.json';\n        this.runtimePath = `${PACKAGE_NAME}/dist/runtime`;\n        this.taroComponentsPath = `${PACKAGE_NAME}/dist/components-react`;\n        this.fileType = {\n            templ: '.ttml',\n            style: '.ttss',\n            config: '.json',\n            script: '.js',\n            xs: '.sjs'\n        };\n        this.template = new Template();\n        this.setupTransaction.addWrapper({\n            close: this.modifyTemplate\n        });\n    }\n    /**\n     * 增加组件或修改组件属性\n     */\n    modifyTemplate() {\n        this.template.mergeComponents(this.ctx, components);\n    }\n}\n\nvar index = (ctx) => {\n    ctx.registerPlatform({\n        name: 'tt',\n        useConfigName: 'mini',\n        fn({ config }) {\n            return __awaiter(this, void 0, void 0, function* () {\n                const extPages = [];\n                yield ctx.modifyAppConfig(({ appConfig }) => {\n                    if (appConfig.pages) {\n                        appConfig.pages = appConfig.pages.map(page => {\n                            if (!page.startsWith('ext://')) {\n                                return page;\n                            }\n                            if (!extPages.includes(page)) {\n                                extPages.push(page);\n                            }\n                        }).filter(Boolean);\n                    }\n                });\n                if (extPages.length > 0) {\n                    yield ctx.modifyBuildAssets(({ assets }) => {\n                        const appJSON = assets['app.json'];\n                        if (appJSON) {\n                            const appJSONContent = JSON.parse(appJSON.source());\n                            appJSONContent.pages = appJSONContent.pages.concat(extPages);\n                            assets['app.json'] = new webpackSources.RawSource(JSON.stringify(appJSONContent, null, 2));\n                        }\n                    });\n                }\n                const program = new TT(ctx, config);\n                yield program.start();\n            });\n        }\n    });\n};\n\nexports.TT = TT;\nexports[\"default\"] = index;\n//# sourceMappingURL=index.js.map\n"]}