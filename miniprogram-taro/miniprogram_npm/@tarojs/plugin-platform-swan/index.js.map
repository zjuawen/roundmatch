{"version":3,"sources":["index.js","dist/index.js"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;ACFA,ADGA;ACFA,ADGA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.js","sourcesContent":["module.exports = require('./dist/index.js').default\n\nmodule.exports.default = module.exports\nmodule.exports.Swan = require('./dist/index.js').Swan\n","\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar shared = require('@tarojs/shared');\nvar service = require('@tarojs/service');\nvar template = require('@tarojs/shared/dist/template');\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nconst components = {\n    // ======== 调整属性 ========\n    Progress: {\n        'border-radius': '0',\n        'font-size': '16',\n        duration: '30'\n    },\n    RichText: {\n        selectable: 'false',\n        name: '',\n        attrs: '',\n        children: '[]',\n        text: '',\n        'image-menu-prevent': 'false',\n        preview: ''\n    },\n    Map: {\n        polygons: '[]',\n        'enable-3D': 'false',\n        'show-compass': 'false',\n        'enable-overlooking': 'false',\n        'enable-zoom': 'true',\n        'enable-scroll': 'true',\n        'enable-rotate': 'false',\n        bindRegionChange: '',\n        bindPoiTap: ''\n    },\n    Button: {\n        'template-id': '',\n        'subscribe-id': '',\n        bindSubscribe: '',\n        bindGetPhoneNumber: '',\n        bindGetUserInfo: '',\n        bindOpenSetting: '',\n        bindContact: '',\n        bindChooseAddress: '',\n        bindChooseInvoiceTitle: '',\n        bindLogin: ''\n    },\n    Form: {\n        'report-type': 'default',\n        'template-id': '',\n        'subscribe-id': '',\n        'skip-subscribe-authorize': 'false'\n    },\n    Input: {\n        'adjust-position': 'true'\n    },\n    Textarea: {\n        'confirm-type': shared.singleQuote('default'),\n        'confirm-hold': 'false',\n        'show-confirm-bar': 'true',\n        'adjust-position': 'true'\n    },\n    Navigator: {\n        target: shared.singleQuote('self'),\n        'app-id': '',\n        path: '',\n        'extra-data': '',\n        version: shared.singleQuote('version')\n    },\n    Image: {\n        webp: 'false',\n        'image-menu-prevent': 'false',\n        preview: '',\n        'original-src': ''\n    },\n    Video: {\n        title: '',\n        'show-no-wifi-tip': 'true',\n        'vslide-gesture': 'false',\n        'vslide-gesture-in-fullscreen': 'true',\n        'enable-play-gesture': 'false',\n        'show-rate-btn': 'false',\n        'show-vslide-btn-in-fullscreen': 'true',\n        'silent-play': 'false',\n        bindLoadedMetadata: ''\n    },\n    Ad: {\n        appid: '',\n        apid: '',\n        type: shared.singleQuote('feed'),\n        updatetime: '',\n        bindStatus: ''\n    },\n    // ======== 额外组件 ========\n    Tabs: {\n        'tabs-background-color': shared.singleQuote('#fff'),\n        'tabs-active-text-color': shared.singleQuote('#000'),\n        'tabs-inactive-text-color': shared.singleQuote('#666'),\n        'tabs-underline-color': shared.singleQuote('#333'),\n        'active-name': '',\n        'url-query-name': '',\n        'max-tab-item-amount': '5',\n        bindTabChange: ''\n    },\n    TabItem: {\n        label: '',\n        name: '',\n        'badge-type': '',\n        'badge-text': ''\n    },\n    AnimationVideo: {\n        'resource-width': '800',\n        'resource-height': '400',\n        'canvas-style': shared.singleQuote('width:400px;height:400px'),\n        path: '',\n        loop: 'false',\n        autoplay: 'false',\n        'alpha-direction': shared.singleQuote('left'),\n        bindStarted: '',\n        bindEnded: ''\n    },\n    AnimationView: {\n        path: '',\n        loop: 'false',\n        autoplay: 'true',\n        action: shared.singleQuote('play'),\n        hidden: 'true',\n        bindEnded: ''\n    },\n    ArCamera: {\n        key: '',\n        type: '',\n        flash: shared.singleQuote('off'),\n        bindError: '',\n        bindLoad: '',\n        bindMessage: '',\n        bindScanCode: ''\n    },\n    RtcRoom: {\n        id: '',\n        'enable-camera': 'true',\n        'enable-auto-focus': 'true',\n        'enable-zoom': 'false',\n        'device-position': shared.singleQuote('front'),\n        'enable-mic': 'true',\n        'enable-agc': 'false',\n        'enable-ans': 'false',\n        bitrate: '900',\n        'video-width': '360',\n        'video-height': '640',\n        'enable-remote-mirror': 'false',\n        'local-mirror': shared.singleQuote('auto'),\n        'sound-mode': shared.singleQuote('speaker'),\n        bindStateChange: '',\n        bindError: ''\n    },\n    RtcRoomItem: {\n        id: '',\n        type: '',\n        'user-id': ''\n    },\n    OpenData: {\n        type: ''\n    },\n    Login: {\n        'button-class': '',\n        'checked-color': shared.singleQuote('#3388FF'),\n        'theme-color': shared.singleQuote('#3388FF'),\n        bindGetPhoneNumber: '',\n        bindLoadError: ''\n    },\n    Like: {\n        'is-liked': 'false',\n        mode: shared.singleQuote('icon'),\n        'icon-type': shared.singleQuote('hand'),\n        'like-text': shared.singleQuote('赞'),\n        'like-num': '0',\n        'like-type': '0',\n        'animation-type': '1',\n        'is-show-toast': 'false',\n        'toast-text': \"['已点赞', '已取消']\",\n        'like-param': '',\n        bindError: '',\n        bindSuccess: '',\n        bindFail: '',\n    },\n    CommentList: {\n        'comment-param': '',\n        'toolbar-config': '',\n        'is-page-scroll': 'true',\n        'need-toolbar': 'true',\n        'add-comment': 'false',\n        'detail-path': '',\n        'is-folded': 'false',\n        'fold-num': '3',\n        'view-more-path': '',\n        'view-more-style': '',\n        bindClickComment: '',\n        bindViewMore: '',\n    },\n    CommentDetail: {\n        'comment-param': '',\n        srid: '',\n        'is-page-scroll': 'true',\n        'need-toolbar': 'true',\n        'need-like-btn': 'true',\n        'back-list-after-delete': 'true',\n        'add-comment': 'false',\n        bindDelete: '',\n    },\n    FollowSwan: {\n        size: shared.singleQuote('default'),\n        type: shared.singleQuote('primary'),\n        bindFavorStatusChange: '',\n    },\n    InlinePaymentPanel: {\n        'total-amount': '',\n        'deal-id': '',\n        'app-key': '',\n        'promotion-tag': '',\n        'enable-page-back-modal': '',\n        'custom-style': '',\n        'style-type': shared.singleQuote('default'),\n        bindGetPaymentInfo: '',\n        bindError: ''\n    },\n};\n\nconst REG_TRACKBY_REPLACEMENT = /s-for=\"{{([A-Za-z]+)\\.cn}}\" s-key=\"sid\"/;\nconst swanSpecialAttrs = {\n    'scroll-view': ['scroll-top', 'scroll-left', 'scroll-into-view'],\n    'movable-view': ['x', 'y'],\n    input: ['value'],\n    textarea: ['value']\n};\nclass Template extends template.RecursiveTemplate {\n    constructor(options) {\n        var _a, _b, _c;\n        super();\n        this.supportXS = true;\n        this.isXMLSupportRecursiveReference = false;\n        this.Adapter = {\n            if: 's-if',\n            else: 's-else',\n            elseif: 's-elif',\n            for: 's-for',\n            forItem: 's-for-item',\n            forIndex: 's-for-index',\n            key: 's-key',\n            xs: 'sjs',\n            type: 'swan'\n        };\n        this.buildFlattenView = (level = this.flattenViewLevel) => {\n            if (level === 0) {\n                return `<template is=\"{{xs.a(0, item.${\"nn\" /* Shortcuts.NodeName */})}}\" data=\"{{{i:item}}}\" />`;\n            }\n            const child = this.buildFlattenView(level - 1);\n            const componentsAlias = this.componentsAlias;\n            const viewAlias = componentsAlias.view._num;\n            const textAlias = componentsAlias.text._num;\n            const staticTextAlias = componentsAlias['static-text']._num;\n            const buttonAlias = componentsAlias.button._num;\n            const inputAlias = componentsAlias.input._num;\n            const swiperAlias = componentsAlias.swiper._num;\n            const template = `<view s-if=\"{{item.nn==='${viewAlias}'&&(item.st||item.cl)}}\" id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('view')}>\n  <block s-for=\"item.cn trackBy item.sid\">\n    ${shared.indent(child, 4)}\n  </block>\n</view>\n<text s-elif=\"{{item.nn==='${textAlias}'&&(item.st||item.cl)}}\" id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('text')}>\n  <block s-for=\"item.cn trackBy item.sid\">\n    <block>{{item.v}}</block>\n  </block>\n</text>\n<text s-elif=\"{{item.nn==='${staticTextAlias}'&&(item.st||item.cl)}}\" id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('static-text')}>\n  <block s-for=\"item.cn trackBy item.sid\">\n    <block>{{item.v}}</block>\n  </block>\n</text>\n<button s-elif=\"{{item.nn==='${buttonAlias}'&&(item.st||item.cl)}}\" id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('button')}>\n  <block s-for=\"item.cn trackBy item.sid\">\n    <template is=\"{{xs.a(0, item.${\"nn\" /* Shortcuts.NodeName */})}}\" data=\"{{{ i:item }}}\" />\n  </block>\n</button>\n<input s-elif=\"{{item.nn==='${inputAlias}'&&(item.st||item.cl)}}\" id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('input')} />\n<swiper s-elif=\"{{item.nn==='${swiperAlias}'&&(item.st||item.cl)}}\" id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('swiper')}>\n  <block s-for=\"xs.f(item.cn) trackBy item.sid\">\n    <template is=\"{{xs.a(0, item.${\"nn\" /* Shortcuts.NodeName */})}}\" data=\"{{{ i:item }}}\" />\n  </block>\n</swiper>\n<block s-else>\n  <template is=\"{{xs.a(0, item.${\"nn\" /* Shortcuts.NodeName */})}}\" data=\"{{{i:item}}}\" />\n</block>`;\n            return template;\n        };\n        this.buildFlattenCover = (level = this.flattenCoverLevel) => {\n            if (level === 0) {\n                return `<template is=\"{{xs.a(0, item.${\"nn\" /* Shortcuts.NodeName */})}}\" data=\"{{{i:item}}}\" />`;\n            }\n            const child = this.buildFlattenCover(level - 1);\n            const componentsAlias = this.componentsAlias;\n            const coverViewAlias = componentsAlias['cover-view']._num;\n            const coverImageAlias = componentsAlias['cover-image']._num;\n            const contentAlias = componentsAlias['#text']._num;\n            const template = `<cover-view s-if=\"{{item.nn==='${coverViewAlias}'}}\" id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('cover-view')}>\n  <block s-for=\"item.cn trackBy item.sid\">\n    ${shared.indent(child, 4)}\n  </block>\n</cover-view>\n<cover-image s-elif=\"{{item.nn==='${coverImageAlias}'}}\" id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\"  ${this.buildFlattenNodeAttributes('cover-image')}></cover-image>\n<block s-elif=\"{{item.nn==='${contentAlias}'}}\">{{item.v}}</block>\n<block s-else>\n  <template is=\"{{xs.a(0, item.${\"nn\" /* Shortcuts.NodeName */})}}\" data=\"{{{i:item}}}\" />\n</block>`;\n            return template;\n        };\n        this.buildFlattenText = (level = this.flattenTextLevel) => {\n            if (level === 0) {\n                return `<block>{{item.${\"v\" /* Shortcuts.Text */}}}</block>`;\n            }\n            const child = this.buildFlattenText(level - 1);\n            const componentsAlias = this.componentsAlias;\n            const contentAlias = componentsAlias['#text']._num;\n            const template = `<block s-if=\"item.nn === '${contentAlias}'\">{{item.v}}</block>\n<text s-else id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('text')}>\n  <block s-for=\"item.cn trackBy item.sid\">\n    ${shared.indent(child, 4)}\n  </block>\n</text>`;\n            return template;\n        };\n        this.modifyLoopBody = (child, nodeName) => {\n            const componentsAlias = this.componentsAlias;\n            const adAlias = componentsAlias.ad._num;\n            switch (nodeName) {\n                case 'view':\n                    // fix issue #6015\n                    return this.buildFlattenView();\n                case 'cover-view':\n                case 'canvas':\n                case 'map':\n                case 'animation-view':\n                case 'camera':\n                case 'live-player':\n                    return this.buildFlattenCover();\n                case 'video': {\n                    const body = `<ad s-if={{item.nn==='${adAlias}'}} id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('ad')}></ad>\n<block s-else>\n  ${shared.indent(this.buildFlattenCover(), 2)}\n</block>`;\n                    return body;\n                }\n                case 'text':\n                case 'static-text':\n                    return this.buildFlattenText();\n                case 'picker-view':\n                    return `<picker-view-column id=\"{{item.uid||item.sid}}\" data-sid=\"{{item.sid}}\" ${this.buildFlattenNodeAttributes('picker-view-column')}>\n          <block s-for=\"item.cn trackBy item.sid\">\n            ${child}\n          </block>\n        </picker-view-column>`;\n                default:\n                    return child;\n            }\n        };\n        this.modifyLoopContainer = (children, nodeName) => {\n            if (nodeName === 'swiper') {\n                return children.replace(/s-for=\"{{i\\.cn}}\"/, 's-for=\"xs.f(i.cn) trackBy item.sid\"');\n            }\n            return children.replace(REG_TRACKBY_REPLACEMENT, 's-for=\"$1.cn trackBy item.sid\"');\n        };\n        this.modifyTemplateResult = (res, nodeName) => {\n            if (nodeName === 'picker-view-column')\n                return '';\n            return res;\n        };\n        this.flattenViewLevel = (_a = options === null || options === void 0 ? void 0 : options.flattenViewLevel) !== null && _a !== void 0 ? _a : 8;\n        this.flattenCoverLevel = (_b = options === null || options === void 0 ? void 0 : options.flattenCoverLevel) !== null && _b !== void 0 ? _b : 3;\n        this.flattenTextLevel = (_c = options === null || options === void 0 ? void 0 : options.flattenTextLevel) !== null && _c !== void 0 ? _c : 3;\n    }\n    buildBaseTemplate() {\n        const rootTmpl = super.buildBaseTemplate();\n        return rootTmpl.replace(REG_TRACKBY_REPLACEMENT, 's-for=\"$1.cn trackBy item.sid\"');\n    }\n    createMiniComponents(components) {\n        const result = super.createMiniComponents(components);\n        this.legacyMiniComponents = Object.assign({}, result);\n        delete result['pure-view'];\n        delete result['static-view'];\n        delete result['catch-view'];\n        return result;\n    }\n    buildXsTemplate(filePath = './utils') {\n        return `<import-sjs module=\"xs\" src=\"${filePath}.sjs\" />`;\n    }\n    dataKeymap(keymap) {\n        return `{ ${keymap} }`;\n    }\n    getAttrValue(value, key, nodeName) {\n        if (shared.isArray(swanSpecialAttrs[nodeName]) && swanSpecialAttrs[nodeName].includes(key)) {\n            return `= ${value} =`;\n        }\n        return `{${value}}`;\n    }\n    buildFlattenNodeAttributes(nodeName) {\n        const component = this.legacyMiniComponents[nodeName];\n        return Object.keys(component)\n            .map(k => `${k}=\"${k.startsWith('bind') || k.startsWith('on') || k.startsWith('catch') ? component[k] : `{{${component[k].replace('i.', 'item.')}}}`}\"`)\n            .join(' ');\n    }\n    buildXSTmpExtra() {\n        const componentsAlias = this.componentsAlias;\n        const swiperAlias = componentsAlias['swiper-item']._num;\n        return `f: function (l) {\n    return l.filter(function (i) {return i.nn === '${swiperAlias}'})\n  }`;\n    }\n}\n\nconst PACKAGE_NAME = '@tarojs/plugin-platform-swan';\nconst PROJECT_JSON = 'project.swan.json';\nclass Swan extends service.TaroPlatformBase {\n    /**\n     * 1. setupTransaction - init\n     * 2. setup\n     * 3. setupTransaction - close\n     * 4. buildTransaction - init\n     * 5. build\n     * 6. buildTransaction - close\n     */\n    constructor(ctx, config, options = {}) {\n        super(ctx, config);\n        this.platform = 'swan';\n        this.globalObject = 'swan';\n        this.runtimePath = `${PACKAGE_NAME}/dist/runtime`;\n        this.taroComponentsPath = `${PACKAGE_NAME}/dist/components-react`;\n        this.fileType = {\n            templ: '.swan',\n            style: '.css',\n            config: '.json',\n            script: '.js',\n            xs: '.sjs'\n        };\n        this.setupTransaction.addWrapper({\n            close() {\n                this.modifyComponents();\n                ctx.generateFrameworkInfo();\n                this.generateProjectConfig(PROJECT_JSON, PROJECT_JSON);\n            }\n        });\n        this.template = new Template({\n            flattenViewLevel: options.flattenViewLevel,\n            flattenCoverLevel: options.flattenCoverLevel,\n            flattenTextLevel: options.flattenTextLevel,\n        });\n    }\n    /**\n     * 增加组件或修改组件属性\n     */\n    modifyComponents() {\n        this.template.mergeComponents(this.ctx, components);\n        delete this.template.internalComponents.Input.cursor;\n        delete this.template.internalComponents.Input['selection-start'];\n        delete this.template.internalComponents.Input['selection-end'];\n    }\n}\n\nvar index = (ctx, options = {}) => {\n    ctx.registerPlatform({\n        name: 'swan',\n        useConfigName: 'mini',\n        fn({ config }) {\n            return __awaiter(this, void 0, void 0, function* () {\n                const program = new Swan(ctx, config, options);\n                yield program.start();\n            });\n        }\n    });\n    ctx.modifyRunnerOpts(({ opts }) => {\n        if (!(opts === null || opts === void 0 ? void 0 : opts.compiler))\n            return;\n        if (shared.isString(opts.compiler)) {\n            opts.compiler = {\n                type: opts.compiler\n            };\n        }\n        const { compiler } = opts;\n        if (compiler.type === 'webpack5') {\n            compiler.prebundle || (compiler.prebundle = {});\n            const prebundleOptions = compiler.prebundle;\n            if (prebundleOptions.enable === false)\n                return;\n            prebundleOptions.swc || (prebundleOptions.swc = {\n                jsc: {\n                    // Note: 由于百度小程序不支持 ES2015，所以这里需要将 ES5 (模拟器环境可无该问题)\n                    target: 'es5'\n                }\n            });\n            prebundleOptions.exclude || (prebundleOptions.exclude = []);\n            prebundleOptions.include || (prebundleOptions.include = []);\n        }\n    });\n};\n\nexports.Swan = Swan;\nexports[\"default\"] = index;\n//# sourceMappingURL=index.js.map\n"]}