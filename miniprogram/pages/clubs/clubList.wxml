<!--miniprogram/pages/clubs/clubList.wxml-->

<mp-navigation-bar loading="{{loading}}" show="{{true}}" title="{{title}}" background="{{'white'}}" back="{{false}}" ></mp-navigation-bar>

<van-notice-bar
  scrollable="{{ true }}"
  text="{{notice}}"
  mode="closeable"
  speed="{{10}}"
  left-icon="volume-o"
/>

<view class="page__bd">
  <mp-searchbar 
    bindselectresult="selectResult" 
    search="{{search}}"
    placeholder="{{'搜索俱乐部'}}" >
    </mp-searchbar>
</view>

<View class="page-body" >

  <view wx:if="{{(clubs.length>0)}}" class="weui-cells__title">已加入的俱乐部</view>
  <view 
  	wx:for="{{ clubs }}"
    wx:key="{{ item._id }}"
  	class="uploader" 
    style="padding-left: 20rpx; margin-top: 0px; margin-bottom: 20rpx;"  >

  	<navigator url="../matches/matchList?clubid={{item._id}}" 
      open-type="navigate" class="uploader-text">

      <view style="display: flex; align-items: center; margin-left: 20rpx;">
        
        <image class='avatar' style="margin: 20rpx;" 
          src="{{ item.logo ? item.logo: '../../images/default-club-logo.svg'}}" mode="aspectFit">
        </image>

        <image wx:if="{{item.vip}}" class='vip' 
          src="{{ '../../images/vip.svg'}}" mode="aspectFit">
        </image>
        
        <text style="flex:7" >{{item.wholeName}}</text>
        <text style="flex:3; align-content: left" > ({{item.shortName}})</text>

<!--         <image wx:if="{{true}}" class='owner' 
          src="{{ '../../images/owner.svg'}}" mode="aspectFit">
        </image>
 -->
      </view>

  	</navigator>

  </view>

  <!-- 
  <view wx:if="{{(publicClubs.length>0)}}" class="weui-cells__title">公开的俱乐部</view>
  <view 
    wx:for="{{ publicClubs }}"
    wx:key="{{ item._id }}"
    wx:for-index="index" 
    class="uploader" 
    style="display: flex; flex-direction:row; padding-left: 20rpx; padding-top: 20rpx; padding-bottom: 20rpx; align-items: center;" >

      <image class='avatar-small' 
        src="../../images/default_club.png" mode="aspectFit">
      </image>

      <view style="flex:2; font-size: 14px; margin-left: 50rpx;" >{{item.wholeName}}</view>

      <image wx:if="{{item.locked}}" class='club-status' 
        src="../../images/locked.png" mode="aspectFit">
      </image>

      <button 
        wx:if="{{(!login)}}"
        class="weui-btn" type="primary" size="mini"
        data-item="{{item}}"
        open-type="getUserInfo" 
        bindgetuserinfo="onGetUserInfo"
        style="flex:1; margin-left: 40rpx; margin-right: 40rpx; font-size: 36rpx;" >
        加入
        </button>

      <button 
        wx:if="{{(login)}}"
        class="weui-btn" type="primary" size="mini"
        data-item="{{item}}"
        bindtap="onClickPublicClub"
        style="flex:1; margin-left: 40rpx; margin-right: 40rpx; font-size: 36rpx;"  >
        加入
        </button>
  </view>
   -->
  <!-- disabled="{{!createClubEnable}}" -->
  <!--  {{createClubEnable? "创建自己的俱乐部" : "仅可以创建一个俱乐部"}} -->     


<button 
      wx:if="{{(debug)}}"
      class="weui-btn" type="primary" 
      bindtap="onClickDebug"
      style="flex:1; margin-Top: 40rpx; margin-left: 40rpx; margin-right: 40rpx; font-size: 36rpx;"  >
      测试
</button>

 <!--  <view 
    style="position: fixed;bottom: 0;margin: 10px; right: 25px;" >
    
    <view 
        class="hyperlink-text" 
        bindtap="onClickDownloadManual" >
        查看用户手册
      </view>

  </view>
 -->
</View>

<button 
      wx:if="{{(createClubEnable)}}"
      class="weui-btn" type="default" size="default" plain="false"
      bindtap="onCreateClub"
      style="margin-Top: 40rpx; margin-bottom: 40rpx; font-size: 36rpx;">
        创建俱乐部
</button>


<mp-dialog title="获取授权" show="{{authDialogShow}}" bindbuttontap="onCancelAuthDialog" buttons="{{[{text: '取消'}]}}">
  <view style="margin: 40rpx;" >{{authDialogMessage}}</view>
  <button 
    class="weui-btn" type="primary" size="default"
    open-type="getUserInfo" 
    bindgetuserinfo="onGetUserInfo">
    点击授权
    </button>
</mp-dialog>

<mp-dialog title="加入俱乐部" show="{{joinDialogShow}}" bindbuttontap="tapDialogButton" buttons="{{buttons}}">
  <block wx:if="{{!selected.locked}}">
    <view>确定要加入"{{selected.wholeName}}"?</view>
  </block>
  <block wx:else >
    <view class="dialog-content-container">
      <view>请输入"{{selected.wholeName}}"密码：</view>
      <input class="password-input" type="password" 
        bindinput="onInputPassword" bindchange="onInputPassword"></input>
    </view>
  </block>
</mp-dialog>

