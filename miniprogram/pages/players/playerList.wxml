<!--miniprogram/pages/players/playerList.wxml-->

<mp-navigation-bar loading="{{loading}}" show="{{true}}" animated="{{animated}}" color="{{/*'red'*/}}" background="{{'white'}}" title="{{title}}" back="{{true}}"></mp-navigation-bar>

<view class="page__bd">

  <view class="player-header" >

    <mp-searchbar 
      class="player-header-search"
      bindselectresult="selectResult" 
      search="{{search}}"
      placeholder="{{'搜索队员'}}" >
      </mp-searchbar>

    <view class="player-header-status" >

      <view style=" flex: 1;color: grey; display: flex; justify-content: center; " >
        请选择4～8{{type=='fixpair'?'对':'人'}}后继续:（ {{selectCount}} ）
        </view>
        
      <button 
        class="weui-btn" type="primary" 
        disabled="{{nextDisable}}"
        size="mini"  bindtap="onPlayerSelectedDone"
        style="margin-left: 40rpx;margin-right: 40rpx;" >
      	下一步
      </button>
    </view>

  </view>

</view>


<view style="height: 200rpx" />

<mp-cells title="已选择" >
  <view wx:if="{{type=='fixpair'}}" >
    <view style="display: flex;" 
      wx:for="{{selectedPlayerPairs}}" 
      wx:key="{{item._id}}">
    <mp-cell class="player-list-cell"
      style="width: 50%;" 
      value="{{item.player1.name}}" 
      data-index="{{index}}" 
      data-slot="{{1}}" 
      bindtap="onDeselectPlayer" >
        <image slot="icon" src="{{item.player1.avatarUrl}}" 
          style="margin-right: 16px;vertical-align: middle;width:20px; height: 20px;">
        </image>
    </mp-cell>
    <mp-cell class="player-list-cell"
      style="width: 50%;" 
      data-index="{{index}}" 
      value="{{item.player2.name}}" 
      data-slot="{{2}}" 
      bindtap="onDeselectPlayer" >
        <image slot="icon" src="{{item.player2.avatarUrl}}" 
          style="margin-right: 16px;vertical-align: middle;width:20px; height: 20px;">
        </image>
    </mp-cell>
    </view>
  </view> 

  <view wx:if="{{type!='fixpair'}}" >
    <mp-cell class="player-list-cell"
      wx:for="{{selectedPlayers}}" wx:key="{{item._id}}"
      data-index="{{index}}" value="{{item.name}}" 
      bindtap="onDeselectPlayer" >
        <image slot="icon" src="{{item.avatarUrl}}" 
          style="margin-right: 16px;vertical-align: middle;width:20px; height: 20px;">
        </image>
    </mp-cell>
  </view>

</mp-cells>

<view style="height: 50rpx" />

<mp-cells title="俱乐部成员" >

  <mp-cell class="player-list-cell"
    wx:for="{{players}}" wx:key="{{item._id}}"
    data-index="{{index}}" value="{{item.name}}" 
    bindtap="onSelectPlayer" >

      <image slot="icon" src="{{item.avatarUrl}}" 
        style="margin-right: 16px;vertical-align: middle;width:20px; height: 20px;">
      </image>

  </mp-cell>

  <!-- <mp-cell class="player-list-item"
    wx:for="{{players}}" wx:key="{{item._id}}"
    data-id="{{item._id}}" bindtap="onSelectPlayer">


    <image wx:if="{{!item.checked}}" class="checkbox" 
      data-id="{{item._id}}" catchtap="onSelectPlayer"
      src="/images/icon-emptybox.svg" mode="aspectFit">
      </image>
    <image wx:else class="checkbox" 
      data-id="{{item._id}}" catchtap="onSelectPlayer"
      src="/images/icon-checkbox.svg" mode="aspectFit">
      </image>

    <image class="avatar" 
      data-id="{{item._id}}" catchtap="onSelectPlayer"
      src="{{item.avatarUrl}}">
      </image>

    <view class="player-item-name" data-id="{{item._id}}" catchtap="onSelectPlayer">
      {{item.name}}
    </view>

  </mp-cell> -->

</mp-cells>

<!-- 
<view class="player-list-item"
  wx:for="{{players}}" wx:key="{{item._id}}"
  data-id="{{item._id}}" bindtap="onSelectPlayer">

  	<image wx:if="{{!item.checked}}" class="checkbox" 
      data-id="{{item._id}}" catchtap="onSelectPlayer"
      src="/images/icon-emptybox.svg" mode="aspectFit">
      </image>
  	<image wx:else class="checkbox" 
      data-id="{{item._id}}" catchtap="onSelectPlayer"
      src="/images/icon-checkbox.svg" mode="aspectFit">
      </image>

    <image class="avatar" 
      data-id="{{item._id}}" catchtap="onSelectPlayer"
      src="{{item.avatarUrl}}">
      </image>

	  <view class="player-item-name" data-id="{{item._id}}" catchtap="onSelectPlayer">
      {{item.name}}
    </view>

</view> -->

<view wx:if="{{noMore}}" class="footer" >
  -------- 已经到底了 --------
</view>
<view wx:else class="footer" >
  <button style="background: transparent; width: 0rpx; margin: 0;" 
    loading="true" disabled="true" ></button>
  加载中......
</view>

